# Lenovo Legion Toolkit

[![Build](https://github.com/BartoszCichecki/LenovoLegionToolkit/actions/workflows/build.yml/badge.svg?branch=master)](https://github.com/BartoszCichecki/LenovoLegionToolkit/actions/workflows/build.yml) [![Join Discord](https://img.shields.io/discord/761178912230473768?label=Legion%20Series%20Discord)](https://discord.com/invite/legionseries)

Это утилита, созданная для ноутбуков Lenovo Legion 5, 5 Pro, 7 и т.д., которая позволяет изменить некоторые параметры, доступные только в Lenovo Vantage.

Она не запускает фоновые службы, использует меньше памяти, практически не использует процессор и не содержит телеметрии.

Присоединяйтесь к Легионерам в Discord: https://discord.com/invite/legionseries!

![screenshot](assets/screenshot.png)

## Предупреждение

**Инструмент поставляется без гарантии. Используйте на свой страх и риск.**

Этот проект - хобби. Я хочу сделать его доступным на большем количестве устройств, но это займет некоторое время, поэтому, пожалуйста, наберитесь терпения и внимательно прочитайте этот readme.

## Пожертвовать

Если вам нравится использовать Lenovo Legion Toolkit, подумайте о пожертвовании.

<a href="https://www.paypal.com/donate/?hosted_button_id=22AZE2NBP3HTL"><img src="LenovoLegionToolkit.WPF/Assets/paypal_button.png" width="200" alt="PayPal Donate" /></a>

<img src="LenovoLegionToolkit.WPF/Assets/paypal_qr.png" width="200" alt="PayPal QR code" />

## Загрузка

Вы можете загрузить установщик со страницы релизов отсюда: [Последний релиз](https://github.com/BartoszCichecki/LenovoLegionToolkit/releases/latest).

## Совместимость

Toolkit совместим со многими ноутбуками Lenovo Legion 2020 и 2021 годов выпуска под управлением Windows 10 и 11. Все тесты, проводимое мной, всегда выполняется с последним обновлением Windows 11 и Legion 5 Pro 16ACH6H.

Если вы получаете сообщение о несовместимости при запуске, вы можете проверить раздел *Contribution* внизу, чтобы узнать, как вы можете помочь. Имейте в виду, что не всегда я могу сделать все опции совместимыми со всем оборудованием, поскольку у меня нет к нему доступа.

**Примечание:** Y-модели (Y540, Y740 и т.д.) имеют ограниченную совместимость, что означает, что не все опции работают.

Список поддерживаемых моделей можно найти здесь: [Compatibility.cs](https://github.com/BartoszCichecki/LenovoLegionToolkit/blob/master/LenovoLegionToolkit.Lib/Utils/Compatibility.cs).

## Возможности

Приложение позволяет:



* Изменять настройки, такие как режим питания, режим зарядки аккумулятора и т.д., доступные только через Vantage.
* Настраивать подсветки 4-зонных клавиатур с RGB и белой подсветкой.
* Изменять частоту обновления дисплея (только для встроенного дисплея).
* Отключать дискретный графический процессор (только для nVidia).
* Смотреть статистику заряда батареи.
* Настраивать действия, которые будут выполняться, когда ноутбук, например, подключен к сети переменного тока.
* Отключать/включать службы Lenovo Vantage и Fn Keys, не удаляя их.

##### Отключение/включение Lenovo Vantage

Вы можете отключить Lenovo Vantage, не удаляя его. Это полезно, если вы хотите, например, проверять обновления.

Вы можете сделать это на странице настроек. Если вы отключите Vantage, он остановит и отключит свои службы, а также отключит все свои стремные запланированные задачи Lenovo. Как только Vantage отключен, он больше не будет запускать какие-либо фоновые процессы при запуске компьютера.

Если вы хотите запустить Lenovo Vantage, вам необходимо повторно включить его с помощью Toolkit-а, в противном случае он предложит переустановить себя.

##### Отключение/включение Fn Keys service

Вы можете отключить Lenovo Vantage, не удаляя его. Это полезно, если вы хотите, например, проверять обновления.

Вы можете сделать это на странице настроек. Если вы отключите Vantage, он остановит и отключит свои службы, а также отключит все свои стремные запланированные задачи Lenovo. Как только Vantage отключен, он больше не будет запускать какие-либо фоновые процессы при запуске компьютера.

Если вы хотите запустить Lenovo Vantage, вам необходимо повторно включить его с помощью Toolkit-а, в противном случае он предложит переустановить себя.

##### Отключение дискретного GPU

Иногда дискретный GPU остается активным, даже когда он не должен этого делать. Это может произойти, например, если вы работаете с внешним экраном и отключаете его - некоторые процессы будут продолжать работать на дискретном графическом процессоре, поддерживая его работоспособность и сокращая время автономной работы.

Есть два способа отключить dGPU:

1. убить все процессы, используюущие dGPU (этот вариант работает лучше всего),
2. отключить dGPU на короткое время, что заставит все процессы перейти на встроенный графический процессор.

Кнопка деактивации будет включена, когда dGPU активен, у вас включен гибридный режим и нет внешних мониторов, подключенных к dGPU. Если вы наведете курсор на кнопку, вы увидите текущее состояние dGPU и список процессов, запущенных на нем.

Имейте в виду, что некоторым приложениям может не понравиться эта функция и они могут крашнуться, когда вы деактивируете графический процессор.

##### Схемы Электропитания Windows

Toolkit автоматически переключит схемы питания Windows при изменении Режима питания И при отключенном Lenovo Vantage.

Однако на некоторых ноутбуках Lenovo Vantage не переключает схемы питания. Если у вас есть один из ноутбуков, на котором Lenovo Vantage не изменяет схемы питания Windows автоматически, вы можете переопределить это поведение в настройках. Это позволит Toolkit всегда изменять схемы питания Windows, даже если Lenovo Vantage работает в фоновом режиме.

##### CPU Boost Modes

Позволяет изменить скрытую настройку планов питания Windows, называемую *Режим повышения производительности процессора*. Немного непонятно, что делают эти опции, но лучшее объяснение приведено здесь:

[Power and performance tuning @microsoft.com](https://docs.microsoft.com/en-us/windows-server/administration/performance-tuning/hardware/power/power-performance-tuning#processor-performance-boost-mode)

[ProcessorPerformanceBoostMode @microsoft.com](https://docs.microsoft.com/en-us/dotnet/api/microsoft.windows.eventtracing.power.processorperformanceboostmode?view=trace-processor-dotnet-1.0)

## Благодарности

Особая благодарность:

* [ViRb3](https://github.com/ViRb3), за создание [Lenovo Controller](https://github.com/ViRb3/LenovoController), который был использован в качестве основы для этого инструмента
* [falahati](https://github.com/falahati), за создание [NvAPIWrapper](https://github.com/falahati/NvAPIWrapper) и [WindowsDisplayAPI](https://github.com/falahati/WindowsDisplayAPI)
* [SmokelessCPU](https://github.com/SmokelessCPU) за помощь с 4-зонной RGB клавиатурой

## Вклад

Я ценю любые ваши отзывы, поэтому, пожалуйста, не стесняйтесь сообщать о проблемах. Пиар также приветствуются!

#### Баги

Если вы обнаружите какие-либо ошибки в приложении, пожалуйста, сообщите о них. Это будет очень полезно, если вы запустите приложение с параметром `--trace` и воспроизведете проблему. Вы можете найти журналы/логи в `%LOCALAPPDATA%\LenovoLegionToolkit\log`. Приложите последний журнал к issue здесь, на GitHub.

Только не запускайте этот параметр постоянно, создается *** очень большое *** количество журналов.

#### Совместимость

Было бы здорово расширить список совместимых устройств, но для этого нужна ваша помощь!

Если вы хотите проверить, правильно ли работает это приложение на вашем устройстве, которое в данный момент не поддерживается, вы можете сделать это, запустив приложение с аргументом ``--skip-compat-check``. Помните, что некоторые функции могут работать неправильно, поэтому имейте это в виду.

Я был бы очень признателен, если бы вы создали issue здесь, на GitHub, с результатами вашего тестирования. Обязательно включите в свой выпуск следующую информацию:

1. Полное имя модели (напр. Legion 5 Pro 16ACH6H)
2. Список функций, которые работают должным образом.
3. Список функций, которые, не работают.
4. Список функций, которые приводят к сбою приложения.

Чем больше информации вы добавите, тем лучше приложение станет со временем.

Заранее спасибо!
